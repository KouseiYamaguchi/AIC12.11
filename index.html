<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>Scroll Gun Showcase</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="scene-wrapper">
    <div class="insight-card">
      <p class="eyebrow">三次元スクロール</p>
      <h1>Scroll to Spin the Gun</h1>
      <p>スクロール量に応じて三次元の銃が回転し、AICで磨いた集中力と直感がリンクするエクスペリエンスを目指しました。ゆっくり下に進むたび、鋭いエッジとダークな金属の光が揺れます。</p>
    </div>
  </div>

  <div class="text-stack">
    <section>
      <h2>Scroll-Controlled Animation</h2>
      <p>スクロール位置は 0~1 に正規化され、ガングループがその値に応じて軸をまわる。ブラウザの縦移動が直接 Three.js のシーンに作用し、ユーザーの動きとオブジェクトの動きが共鳴します。</p>
    </section>
    <section>
      <h2>Gun Detail</h2>
      <p>バレル、カバー、ハンドルを別々の BoxMesh で表現し、金属の質感を持たせたマテリアルで構成。ローズゴールド、黒、赤のライトでアプローチし、ディテールが浮き立つように調整しています。</p>
    </section>
    <section>
      <h2>Keep Scrolling</h2>
      <p>スクロールが止まると銃も減速し、ゆっくりと回転をキープ。再び上下に移動すると照明の反射も変わって、静かな劇場感を演出します。</p>
    </section>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r152/three.min.js"></script>
  <script>
    const scene = new THREE.Scene();
    scene.fog = new THREE.Fog(0x050104, 15, 120);

    const camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 500);
    camera.position.set(0, 0, 60);

    const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.setClearColor(0x030303, 1);
    document.body.appendChild(renderer.domElement);

    const ambient = new THREE.AmbientLight(0xffffff, 0.45);
    scene.add(ambient);

    const keyLight = new THREE.DirectionalLight(0xffca62, 1.1);
    keyLight.position.set(40, 20, 60);
    scene.add(keyLight);

    const rimLight = new THREE.DirectionalLight(0xff2d3d, 0.8);
    rimLight.position.set(-30, 15, 20);
    scene.add(rimLight);

    const gunGroup = new THREE.Group();

    const barrel = new THREE.Mesh(
      new THREE.BoxGeometry(22, 2.2, 2.2),
      new THREE.MeshStandardMaterial({ color: 0xd3aa58, metalness: 0.95, roughness: 0.15 })
    );
    barrel.position.x = 6;
    gunGroup.add(barrel);

    const receiver = new THREE.Mesh(
      new THREE.BoxGeometry(11, 3.3, 3.3),
      new THREE.MeshStandardMaterial({ color: 0x121212, metalness: 0.8, roughness: 0.2 })
    );
    receiver.position.set(-1, -0.7, 0);
    gunGroup.add(receiver);

    const handle = new THREE.Mesh(
      new THREE.BoxGeometry(3.5, 8, 1.8),
      new THREE.MeshStandardMaterial({ color: 0x1a1a1a, metalness: 0.5, roughness: 0.35 })
    );
    handle.position.set(-3.5, -4.2, 0);
    handle.rotation.z = -0.3;
    gunGroup.add(handle);

    const sight = new THREE.Mesh(
      new THREE.BoxGeometry(6.5, 0.7, 0.7),
      new THREE.MeshStandardMaterial({ color: 0xff3e2f, emissive: 0x7f1c11, emissiveIntensity: 0.6 })
    );
    sight.position.set(12, 1.1, 0);
    gunGroup.add(sight);

    scene.add(gunGroup);

    const scrollState = { value: 0, target: 0 };
    window.addEventListener('scroll', () => {
      const docHeight = document.body.scrollHeight - window.innerHeight;
      const scrollPercent = docHeight > 0 ? window.scrollY / docHeight : 0;
      scrollState.target = scrollPercent;
    });

    function animate() {
      requestAnimationFrame(animate);
      scrollState.value += (scrollState.target - scrollState.value) * 0.08;
      gunGroup.rotation.y = scrollState.value * Math.PI * 2;
      gunGroup.rotation.x = scrollState.value * 0.4;
      renderer.render(scene, camera);
    }
    animate();

    window.addEventListener('resize', () => {
      renderer.setSize(window.innerWidth, window.innerHeight);
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
    });
  </script>
</body>
</html>
