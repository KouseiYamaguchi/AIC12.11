<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>AICパーティクルプレイ</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="info-card">
    <p class="eyebrow">p5.js Experiment</p>
    <h1>AICのきらめく波動</h1>
    <p>粒子たちが自由に動きながら、近づくと光のラインでつながる。上の状態は慶應義塾大学AICで交わるアイデアの交差点を表現しています。</p>
  </div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.6.0/p5.min.js"></script>
  <script>
    const particles = [];
    const maxParticles = 160;
    const linkDistance = 140;

    class Particle {
      constructor() {
        this.position = createVector(random(width), random(height));
        this.velocity = p5.Vector.random2D().mult(random(0.4, 1.5));
        this.size = random(2, 5);
        this.hue = random(150, 220);
      }

      update() {
        this.position.add(this.velocity);
        if (this.position.x > width || this.position.x < 0) {
          this.velocity.x *= -1;
        }
        if (this.position.y > height || this.position.y < 0) {
          this.velocity.y *= -1;
        }
      }

      draw() {
        noStroke();
        fill(this.hue, 180, 250, 200);
        circle(this.position.x, this.position.y, this.size);
      }
    }

    function setup() {
      createCanvas(windowWidth, windowHeight);
      colorMode(HSB);
      for (let i = 0; i < maxParticles; i += 1) {
        particles.push(new Particle());
      }
    }

    function draw() {
      background(220, 80, 5, 30);
      particles.forEach((particle, idx) => {
        particle.update();
        particle.draw();
        for (let j = idx + 1; j < particles.length; j += 1) {
          const target = particles[j];
          const d = dist(
            particle.position.x,
            particle.position.y,
            target.position.x,
            target.position.y
          );
          if (d < linkDistance) {
            const alpha = map(d, 0, linkDistance, 190, 0);
            stroke(180, 150, 250, alpha);
            strokeWeight(1);
            line(
              particle.position.x,
              particle.position.y,
              target.position.x,
              target.position.y
            );
          }
        }
      });
    }

    function windowResized() {
      resizeCanvas(windowWidth, windowHeight);
    }
  </script>
</body>
</html>
